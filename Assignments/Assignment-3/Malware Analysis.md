# Technical Write-Up

The malware is distributed via a .doc file claiming to be from the BU IT Help Center, containing a VBA Script.

The VBA Script first checks to see if "C:\malware\ch0nky.txt" exists. If it doesn't exist, the malware simply kills the winword (Microsoft Word) process, displaying a message that says - "A critical Error has been encountered!"

C2 Host IP: 159.65.231.129

If it does exist, it downloads a file from "http://ch0nky.chickenkiller.com/ItSupport.exe" as User-Agent "ch0nky", saving it in the temp directory as "UpdateConfig.exe", then runs UpdateConfig.exe via a hidden window.

The SHA256 hash for this "UpdateConfig.exe" file is AADCA7FC0156900AB61896E5069EBD08B86115E2811AC4387E38852593141584. It has a icon image of the iconic doge and is UPX Packed.

On Unpacking, the SHA256 hash is BBEC96F83A7EBFE16114934DAB38B796AE296BFCC8FF6C8BC97511F872DEC86D.

"UpdateConfig.exe" first checks to see if "C:\malware\ch0nky.txt" exists. If it doesn't exist, the malware displays a MessageBox saying "Sorry. You are not a winner" with a button "Sad". If it does exist, the malware displays a MessageBox saying "Congratulations on winning!" and a button saying "Wow".

It also downloads a file from "http://ch0nky.chickenkiller.com/update.exe", saving it as "MicrosoftUpdate.exe" in a certain location, and deleting the cache entry for the URL. This requests permissions to execute ASM at the same execution level as the invoker.

The malware uniquely identifies the device using the MachineGuid retrieved from Registry Key `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography` using RegOpenKeyExA, reading the value using RegQueryValueExA, and subsequently closing the key using RegCloseKey. It also opens the Registry Key `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run` and writes in an entry for "ch0nk" using RegSetValueExA, running the executable every time the user logs in.

The HTTP request made to "http://ch0nky.chickenkiller.com/register.php" takes in a hardcoded auth token as a parameter `auth=d50fb4bbb04a6a28ec1c56ecbc463510`, the GUID of the user's machine passed in as `guid`, the user's username from GetUserNameA passed in as `user`, and the user's computer's name from GetComputerNameA as `computer` with the content type header as Content-Type: application/x-www-form-urlencoded.

The SHA256 hash for this "MicrosoftUpdate.exe" file is 8E6F8268E6986E15A8D14011F5B03B00F8484F9635E402E9A35A849E2971AD96, compiled with clang.

Final Payload:

1. defense evasion
2. Execution
3. Persistence (does it have a mechanism to stay on the machine?)
4. What commands does it pull down from the server?
5. Is there a final stage payload that we haven't observed yet?
