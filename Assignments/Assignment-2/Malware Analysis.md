# Technical Write-Up

The malware is distributed via a .doc file claiming to be from the BU IT Help Center, containing a VBA Script.

The VBA Script first checks to see if "C:\malware\ch0nky.txt" exists. If it doesn't exist, the malware simply kills the winword (Microsoft Word) process, displaying a message that says - "A critical Error has been encountered!"

C2 Host IP: 159.65.231.129

If it does exist, it downloads a file from "http://ch0nky.chickenkiller.com/ItSupport.exe" as User-Agent "ch0nky", saving it in the temp directory as "UpdateConfig.exe", then runs UpdateConfig.exe via a hidden window.

The SHA256 hash for this "UpdateConfig.exe" file is 9d5a1eecd236d61e3242850d0487808091fc5d0db0a3e45be8970bdbf1fdff88. It has a icon image of the iconic doge.

"UpdateConfig.exe" first checks to see if "C:\malware\ch0nky.txt" exists. If it doesn't exist, the malware displays a MessageBox saying "Sorry. You are not a winner" with a button "Sad". If it does exist, the malware displays a MessageBox saying "Congratulations on winning!" and a button saying "Wow".

It also downloads a file from "http://ch0nky.chickenkiller.com/update.exe", saving it as "MicrosoftUpdate.exe" in a certain location, and deleting the cache entry for the URL. This requests permissions to execute ASM at the same execution level as the invoker.

The malware uniquely identifies the device using the MachineGuid retrieved from Registry Key `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography` using RegOpenKeyExA, reading the value using RegQueryValueExA, and subsequently closing the key using RegCloseKey. It also opens the Registry Key `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run` and writes in an entry for "ch0nk" using RegSetValueExA, running the executable every time the user logs in.

The HTTP request made to "http://ch0nky.chickenkiller.com/register.php" takes in a hardcoded auth token as a parameter `auth=d50fb4bbb04a6a28ec1c56ecbc463510`, the GUID of the user's machine passed in as `guid`, the user's username from GetUserNameA passed in as `user`, and the user's computer's name from GetComputerNameA as `computer` with the content type header as Content-Type: application/x-www-form-urlencoded.

The SHA256 hash for this "MicrosoftUpdate.exe" file is da7d6cebf27b080486d471f56b8145ba2a4ae862fae6e9a8ce0c7ed8ac9a6de1, compiled with clang and has an internal name of ch0nk.

Final Payload:

1. What type of malware is this - Stealer, because it seems to be sending the C2 server user data.
2. What functionality does it have - Gets Device GUID, Username and Computer Name and sends it to C2 Server.
3. How does the malware uniquely identify victims? - Using the Device GUID
4. What kind of system information does it collect from the victim machine? - GUID, Username and Computer Name
5. How could you detect it by inspecting network/HTTP traffic. Are there any suspicious headers? - user-agent ch0nky
6. What compiler was used? - clang
7. What is the internal name of the executable? - ch0nk
